# 《高性能 JavaScript》

> 本书承载着JavaScript性能方面最为宝贵的经验，从语言特性、数据结构、浏览器机理、网络传输等层面分析导致性能问题的原因，还介绍了多种工具来帮助我们提升开发过程和部署环节的工作

## 加载和执行

  **脚本位置**  

  浏览器使用单一线程处理UI刷新和JavaScript执行，页面生命周期内脚本执行可能会修改页面内容，浏览器会停止下来解析`<script>`标签(内嵌或外链)和执行，会阻塞页面渲染和交互。  

- `编程提示 1`：浏览器解析到`<body>`标签前不会渲染页面内容，而脚本会阻塞其他资源下载，故推荐将`<script>`标签尽可能放置到`<body>`标签底部

  **组织脚本**  
  
  从限制外链和内嵌脚本的数量方向入手，也可以改善页面加载的性能效果

- `编程提示 2`：通过合并JS减少`<script>`标签数量，减小脚本大小也是一个方向，如使用webpack将公共模块抽取及异步加载模块，先只加载必须的代码再异步载入其余代码

  **无阻塞的脚本**

  无阻塞脚本指页面加载完成后(即触发`window.onload`事件)，才加载JavaScript，`<script>`标签中可添加`async`和`defer`属性用于并行下载脚本不产生阻塞，区别在于async是加载完成后自动执行(async间不保证执行顺序)，而defer需等待页面完成后执行(defer间按顺序执行)  
  可以使用JS动态创建脚本元素，监听脚本加载完成事件`script.onload`触发回调，IE中判断脚本加载完成使用`script.onreadystatechange`判断`readyState`取值是否为`loaded`或`complete`，如果同域内可以使用XHR对象请求JS文件当`xhr.readyState == 4`时赋值`script.text = xhr.responseText`再添加到页面执行

- `编程提示 3`：使用无阻塞方式加载JavaScript，`<script>`标签defer属性、动态创建脚本元素插入到页面执行

## 数据存取

  数据存储位置关系到数据的读取速度，JS中有四种基本的数据存取位置，总的来说字面量和局部变量的访问速度快于数组项和对象成员的访问速度  

   1. 字面量，JS中字面量有字符串、数字、布尔值、对象、数组、函数、正则表达式及特殊的null和undefined值，它们只代表自身不存储在特定位置
   2. 本地变量，使用关键字var定义的数据存储单元
   3. 数组元素，存储在JS数组对象内部，以数组为索引
   4. 对象成员，存储在JS对象内部，以字符串为索引

  **管理作用域**  

  每个JS函数都是Function对象的一个实例，其内部属性`[[Scope]]`包含了函数被创建的作用域中对象集合，这一集合称为函数的作用域链，执行函数时会创建执行上下文，遇到变量时会经过标识符解析即搜索执行环境中的作用域链查找同名标识符，如果名字相同的两个变量位于不同作用域那么就近优先，类似查找原型链般前者遮蔽后者  
  标识符解析是有代价的，全局变量总存在于执行环境作用域链的最末端读写最慢，而函数中读写局部变量最快  
  改变作用域链，`with`语句可以将传入的对象推入到作用域链首位，with内的局部变量会先从传入的对象检索；`try-catch`语句的catch字句类似，它将异常对象推入一个变量对象置顶于作用域链，

- `编程提示 4`：在未优化的JS引擎浏览器中，尽可能使用局部变量，如果某一跨作用域的值被引用一次以上，那么将它存储到局部变量，使用局部变量复制值(值的引用)，减少作用域链的检索路径

-

  **对象成员**
  
## DOM编程

  **浏览器中的DOM**  
  **DOM访问与修改**  
  **重绘与重排**  
  **事件委托**  

## 算法和流程控制

  **循环**  
  **条件语句**  
  **递归**  

## 字符串和正则表达式

  **字符串连接**  
  **正则表达式优化**  
  **去除字符串首尾空白**  

## 快速响应的用户界面

  **使用定时器让出时间片段**  
  **Web Workers**

## Ajax

  **数据传输**  
  **数据格式**
  **Ajax性能指南**

## 编程实践

  **避免双重求值**  
  **使用Objective/Array直接量**
  **避免重复工作**
  **使用速度快的部分**

## 构建并部署高性能JavaScript应用

## 工具
