# 《CSS 选择器世界》读书笔记
## 1. 概述
- CSS选择器简单却很强，特定的选择符号组合成样式后，可以为用户体验提供助力。
- CSS选择器分4类，即选择器、选择符、伪类和伪元素
  - 选择器：常见的有类选择器、标签选择器、ID选择器、通配选择器...
  - 选择符：` `空格表后代、`>`表子代、`+`表直接相邻节点、`~`表兄弟节点、`||-`表列关系
  - 伪类：如:hover，有一个冒号与浏览器行为、用户行为关联
  - 伪元素: 如::before有两个冒号，会在HTML中生成相应虚拟节点
---
## 2. CSS选择器的优先级
- CSS优先级规则等级划分
  - 0级(数值0)：通配选择器(`*`)、选择符和逻辑伪类(`:not()`、`:is()`、 `:where()`)，其中只有`:is()`伪类括号中的选择器可以影响优先级
  - 1级(数值1)：标签选择器
  - 2级(数值10)：类选择器、属性选择器和伪类
  - 3级(数值100)：ID选择器，最小限度关联样式使用，为了方便重置样式优先使用类选择器
  - 4级(数值1000)：元素的style属性内联，另外`<style>`标签HTML内联样式规则优先于`<link>`标签引入的外部样式
  - 5级(数值infinite)：`!important`，顶级优先级，限制使用，可以使用的场景是使JavaScript设置无效
- `后来居上`原则
  - 优先级数值一致时后声明的优先
  - 低耦合增加优先级数值的技巧，类选择器+必然存在的属性选择器，如`.foo[class] {}`
---
## 3. CSS选择器的命名
### 选择器是否区分大小写
- 和HTML标签、属性一致，CSS的标签选择器、属性选择器对大小写不敏感
- 浏览器直接在`]`前加`i`以忽略大小写，如`[class~="val" i]`
### 选择器的命名合法性
- 首字符支持`a-z、A-Z、下划线(_)及非ASCII字符(中文、全角字符)`
- 后续字符比首字符多支持`0-9和短横线(-)`
- 选择器命名不能可以数字开头，但可以使用`Unicode`编码后的数字表示
### 选择器的命名
- CSS选择器的语义是为了方便人的识别，对于机器而言HTML的语义才显的重要，过长的单词书写和文件大小是个小负担，长命名价值有限，所以使用短命名
- 单命名可能会出现冲突，可以使用BEM(`type-block__element_modifier`，中划线作连字符，双下划线连接块与块的子元素，单下划线描述块或子元素的状态)形式的组合命名
- 面向语义是指根据元素上下文命名，面向属性是指单纯实现某一类CSS效果无关HTML结构，面向属性命名重用性高、方便快捷但场景有限，面向语义命名灵活丰富、场景宽泛但效率低，实际大项目中需要组合两种方式使用。
- 命名可以中文对应英文`专有名词`、`HTML标签`、`HTML特定属性值`、`HTML布尔属性值`、`CSS伪类`、`SVG`等参考语义化的短命名
### 选择器的最佳实践
- `不使用ID选择器`，ID选择器性能虽好但优先级太高不易覆盖，可以使用ID属性选择器替代，元素ID主要用在JS中会与JS耦合，与样式关联后可维护性大打折扣
- `不要嵌套选择器`，平常使用scss、less很容易书写出多层嵌套的样式需要更多的计算，会导致渲染性能糟糕，`CSS选择器是从右往左匹配渲染的`，使用标签选择器匹配页面元素多时也会导致渲染性能问题；过多嵌套会使优先级混乱，不能低成本重置样式；多层嵌套还会使样式布局脆弱，他限定了HTML结构，增大了维护成本；应该使用无嵌套的纯类名选择器，易扩展、易维护、代码少、性能高
- `不要歧视面向属性的命名`，场景有清除浮动、文字过长截断、公共UI样式等，可以直接在HTML class属性中加上直接使用
- `正确的使用状态类名`，页面交互上的选中、激活等状态，使用`.active`、`.checked`等(命名参考HTML属性)作为纯状态标识，即`.active`自身不带CSS样式，应该组合其他类名生成样式达到交互效果，JS中只需添加纯状态类名，使样式和行为分离，最佳实践是根据当前情况权衡出最好的实践
---
## 4. 精通CSS选择符
### 后代选择符空格
- CSS中后代选择器优先级遵循选择器优先级数值权重和后来居上原则，后代选择符会匹配所有子元素
- JS中后代选择符，`document.querySelectorAll()`为全局特性，可以使用`:scope`限制作用域，如`document.querySelector('#myId').querySelectorAll(':scope div div').length;`
### 子选择符箭头(>)
- 子选择符只匹配直接子代元素，匹配性能优于后代选择符但性能优势有限，且选用子选择符有维护成本，元素层级被绑定后续若修改层级需要调整CSS代码
- 使用子选择符主要是为了避免冲突，适用于状态类名祖先后代控制、标签重复嵌套受限、层级位置与动态判断，子选择符可以精确控制CSS影响的结构，但同时失去弹性和变化
### 相邻兄弟选择符加号(+)
- 只匹配后面相邻的一个兄弟节点
- 忽略文本节点和注释节点
- 可实现类似`:first-child`的效果，如`.cs-li + .cs-li { margin-top: 1em; }`，由于相邻兄弟选择器只匹配后一个元素，第一个不会被匹配到
- 众多高级选择器技术的核心，可以配合诸多伪类低成本实现实用的交互效果，如输入框focus时显示之前隐藏的文本提示
### 随后兄弟选择符(~)
- 与相邻兄弟选择符大体类似，区别在于随后兄弟选择符会匹配后面所有的兄弟元素
- 浏览器解析HTML文档由上而下，若CSS支持前面兄弟选择符或父选择器，则页面需要等所有子元素加载完毕才可以渲染，会造成不好的呈现体验
- 视觉上实现前面兄弟选择器效果，HTML结构不变，可以使用float、absolute、transform等具有定位特性的CSS属性，还可以使用direction、writing-mode及flex布局控制文档流呈现位置，如评星组件中的单选框可以使用`flex-flow: row-reverse;`配合`~`实现结构和视觉相反的评星效果
### 双管道选择符(||)
- 浏览器兼容性还不足以实际应用，场景是用于table和grid布局中一整列样式的控制
## 5. 元素选择器
### 选择器的级联语法
- 元素选择器包括标签选择器和通配符选择器，元素选择器是唯一不能重复自身的选择器，且元素选择器级联使用时必须写在最前面，如`input[type="radio"]`
- 类、ID和属性选择器都可以重复自身，且由于CSS选择器是由右往左解析，类名写在后面更好，如`[type="radio"].input`
### 标签选择器
- 标签选择器一般使用与固定组合的标签元素，如原生的表格、列表
- 如果原生属性是某些标签元素特有的，那么标签选择器可以忽略，直接使用书写选择器
- IE9以上支持自定义元素标签选择器
### 通配符选择器
- 指代所有类型的标签元素，包括自定义元素和`<script>`、`<style>`、`<title>`等，但不含伪元素，重置样式可`*, ::before, ::after {}`，通配符和其他选择器级联使用时可以省略星号，只有单独使用通配符时才呈现星号字符
---
## 6. 属性选择器
### ID选择器和类选择器
- 同属属性选择器，但语法、优先级以及可重复性不同
### 属性值直接匹配选择器
- `[attr]`表示匹配包含指定的属性元素，适用于HTML布尔属性如disabled，但有一个特例是`[checked]`选择器，表单控件在checked状态变化时并不会同步修改checked属性的值，需要JS赋值DOM属性checked修复或者使用`:checked`伪类替代`[checked]`
- [attr="val"]是属性值完全匹配选择器，如`[data-type="1"]`，若属性值包含空格则需要转义
- [attr~="val"]是属性值单词完全匹配选择器，用于匹配关键词
- [attr!="val"]是属性值起始平淡完全匹配选择器，表示元素属性其值正好是val或val-(U+002D)开头
- AMCSS(Attribute Modules for CSS)表示借助HTML属性进行CSS开发
### 属性值正则匹配选择器
- [attr^="val"]表匹配attr熟悉值已字符val开头的元素，可以匹配中文，一般用于匹配a元素的链接地址类型
- [attr$="val"]表匹配attr属性值以字符val结尾的元素，一般用于判断链接后缀
- [attr*="val"]表匹配attr属性值包含字符val的元素，如匹配style属性值`[style*="none"]`
- 字母i忽略属性值大小写正则匹配运算符，如`[data-search]:not([data-search*="value" i]) { display: none }`
---
## 7. 用户行为伪类
---
## 8. URL定位伪类
---
## 9. 输入伪类
---
## 10. 树结构伪类
---
## 11. 逻辑组合伪类
---
## 12. 其他伪类选择器
